{"Timestamp":"2025-06-06T13:07:30.0329394+08:00","Level":"Information","MessageTemplate":"{HttpLog:l}","TraceId":"5164703b70b87a68bb43654c47f389f1","SpanId":"31538fa30d5c1ee2","StartDateTime":"2025-06-06T13:07:28.3634104+08:00","AuditLogId":"c48b2d13b45549e28ca6c878f159981b","Headers":["[Connection, close]","[Host, localhost:7430]","[User-Agent, vscode-restclient]","[Accept-Encoding, gzip, deflate]","[Content-Type, application/fhir+json]","[Content-Length, 399]","[x-api-key, fhirnexus-test]"],"Protocol":"HTTP/1.1","Method":"POST","Scheme":"https","PathBase":"","Path":"/Appointment","Connection":"close","Host":"localhost:7430","User-Agent":"vscode-restclient","Accept-Encoding":"gzip, deflate","Content-Type":"application/fhir+json; charset=utf-8","Content-Length":"4636","x-api-key":"[Redacted]","CorrelationId":"0HND4MPOA7TJ6:00000001","OperationOutcome":"{\"resourceType\":\"OperationOutcome\",\"id\":\"0HND4MPOA7TJ6:00000001\",\"issue\":[{\"severity\":\"error\",\"code\":\"exception\",\"details\":{\"text\":\"Unable to find matching expression\"},\"diagnostics\":\"System.InvalidOperationException: Unable to find matching expression\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresQueryGenerator`1.<VisitSearchParameter>g__RemoveResourceType|9_0(String expression, <>c__DisplayClass9_0& ) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresQueryGenerator.cs:line 154\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresQueryGenerator`1.VisitSearchParameter(SearchParameterExpression expression, PostgresQueryGeneratorContext`1 context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresQueryGenerator.cs:line 107\\r\\n   at Ihis.FhirEngine.Data.Search.Expressions.SearchParameterExpression.AcceptVisitor[TContext,TOutput](IExpressionVisitor`2 visitor, TContext context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/Expressions/SearchParameterExpression.cs:line 33\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresQueryGenerator`1.VisitMultiary(MultiaryExpression expression, PostgresQueryGeneratorContext`1 context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresQueryGenerator.cs:line 65\\r\\n   at Ihis.FhirEngine.Data.Search.Expressions.MultiaryExpression.AcceptVisitor[TContext,TOutput](IExpressionVisitor`2 visitor, TContext context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/Expressions/MultiaryExpression.cs:line 71\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresSearchService`1.SearchInternalAsync(SearchOptions searchOptions, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresSearchService.cs:line 56\\r\\n   at Ihis.FhirEngine.Data.Search.SearchService.SearchImplAsync(IReadOnlyList`1 queryParameters, Func`2 searchOptionsFactory, Boolean isHistory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/SearchService.cs:line 128\\r\\n   at Ihis.FhirEngine.Data.Search.SearchService.SearchAsync(String resourceType, IReadOnlyList`1 queryParameters, Boolean isHistory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/SearchService.cs:line 98\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.ExecuteSearchAndSaveToCache(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 331\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.GetSearchFromCacheOrCreate(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 320\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.ExecuteSearchAndSaveToCache(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 331\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.GetSearchFromCacheOrCreate(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 320\\r\\n   at Synapxe.FhirWebApi.PostgresDoc.Handlers.AppointmentDataFhirHandler.ValidateNoAppointmentConflictAsync(IFhirContext context, Appointment appointment, CancellationToken cancellationToken) in C:\\\\workspace\\\\repo\\\\1.fhir\\\\FHIRNexus.Demo\\\\PostgreSQL\\\\Synapxe.FhirWebApi.PostgresDoc\\\\src\\\\Synapxe.FhirWebApi.PostgresDoc\\\\Handlers\\\\AppointmentDataFhirHandler.cs:line 64\\r\\n   at Ihis.FhirEngine.Core.Handlers.FhirHandlerExceptionWrapper.ProcessAsync(IFhirContext context, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Core/Handlers/FhirHandlerExceptionWrapper.cs:line 56\",\"location\":[\"ValidateNoAppointmentConflictOnCreate\"],\"expression\":[\"ValidateNoAppointmentConflictOnCreate\"]}]}","Action":"Create","ActionType":"C","StatusCode":500,"Duration":1668.4206,"EventId":{"Id":9,"Name":"RequestResponseLog"},"SourceContext":"Microsoft.AspNetCore.HttpLogging.HttpLoggingMiddleware","RequestId":"0HND4MPOA7TJ6:00000001","RequestPath":"/Appointment","ConnectionId":"0HND4MPOA7TJ6","AppId":"Synapxe.FhirWebApi.PostgresDoc","AppVersion":"1.0.0+fcef90f242f3d21864a7ad36429586c1178cc125","MachineName":"\"WB-DESKTOP\""}
{"Timestamp":"2025-06-06T13:08:39.0690753+08:00","Level":"Information","MessageTemplate":"{HttpLog:l}","TraceId":"5d8c7819387565f0c3ce03732ec9e88f","SpanId":"be2c151e68d8018e","StartDateTime":"2025-06-06T13:08:39.0313188+08:00","AuditLogId":"3dd6f04d9c524428be908bc5c9694fcb","Headers":["[Connection, close]","[Host, localhost:7430]","[User-Agent, vscode-restclient]","[Accept-Encoding, gzip, deflate]","[x-api-key, fhirnexus-test]"],"Protocol":"HTTP/1.1","Method":"GET","Scheme":"https","PathBase":"","Path":"/metadata","Connection":"close","Host":"localhost:7430","User-Agent":"vscode-restclient","Accept-Encoding":"gzip, deflate","x-api-key":"[Redacted]","CorrelationId":"0HND4MPOA7TJ8:00000001","Target_TypeName":"CapabilityStatement","Target_ResourceId":null,"Action":"Metadata","ActionType":"R","StatusCode":200,"Content-Type":"application/fhir+json; charset=utf-8","Content-Length":"245039","Duration":37.5445,"EventId":{"Id":9,"Name":"RequestResponseLog"},"SourceContext":"Microsoft.AspNetCore.HttpLogging.HttpLoggingMiddleware","RequestId":"0HND4MPOA7TJ8:00000001","RequestPath":"/metadata","ConnectionId":"0HND4MPOA7TJ8","AppId":"Synapxe.FhirWebApi.PostgresDoc","AppVersion":"1.0.0+fcef90f242f3d21864a7ad36429586c1178cc125","MachineName":"\"WB-DESKTOP\""}
{"Timestamp":"2025-06-06T13:11:31.3413266+08:00","Level":"Information","MessageTemplate":"{HttpLog:l}","TraceId":"e79ae2f63ba878abad83a09e85744af3","SpanId":"04e5316aa05148ff","StartDateTime":"2025-06-06T13:11:31.3038154+08:00","AuditLogId":"77b835b3844a48688176b228e9fa6aa0","Headers":["[Connection, close]","[Host, localhost:7430]","[User-Agent, vscode-restclient]","[Accept-Encoding, gzip, deflate]","[Content-Type, application/fhir+json]","[Content-Length, 399]","[x-api-key, fhirnexus-test]"],"Protocol":"HTTP/1.1","Method":"POST","Scheme":"https","PathBase":"","Path":"/Appointment","Connection":"close","Host":"localhost:7430","User-Agent":"vscode-restclient","Accept-Encoding":"gzip, deflate","Content-Type":"application/fhir+json; charset=utf-8","Content-Length":"4636","x-api-key":"[Redacted]","CorrelationId":"0HND4MPOA7TJA:00000001","OperationOutcome":"{\"resourceType\":\"OperationOutcome\",\"id\":\"0HND4MPOA7TJA:00000001\",\"issue\":[{\"severity\":\"error\",\"code\":\"exception\",\"details\":{\"text\":\"Unable to find matching expression\"},\"diagnostics\":\"System.InvalidOperationException: Unable to find matching expression\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresQueryGenerator`1.<VisitSearchParameter>g__RemoveResourceType|9_0(String expression, <>c__DisplayClass9_0& ) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresQueryGenerator.cs:line 154\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresQueryGenerator`1.VisitSearchParameter(SearchParameterExpression expression, PostgresQueryGeneratorContext`1 context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresQueryGenerator.cs:line 107\\r\\n   at Ihis.FhirEngine.Data.Search.Expressions.SearchParameterExpression.AcceptVisitor[TContext,TOutput](IExpressionVisitor`2 visitor, TContext context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/Expressions/SearchParameterExpression.cs:line 33\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresQueryGenerator`1.VisitMultiary(MultiaryExpression expression, PostgresQueryGeneratorContext`1 context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresQueryGenerator.cs:line 65\\r\\n   at Ihis.FhirEngine.Data.Search.Expressions.MultiaryExpression.AcceptVisitor[TContext,TOutput](IExpressionVisitor`2 visitor, TContext context) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/Expressions/MultiaryExpression.cs:line 71\\r\\n   at Ihis.FhirEngine.Data.PostgreSQL.Search.PostgresSearchService`1.SearchInternalAsync(SearchOptions searchOptions, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.PostgreSQL/Search/PostgresSearchService.cs:line 56\\r\\n   at Ihis.FhirEngine.Data.Search.SearchService.SearchImplAsync(IReadOnlyList`1 queryParameters, Func`2 searchOptionsFactory, Boolean isHistory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/SearchService.cs:line 128\\r\\n   at Ihis.FhirEngine.Data.Search.SearchService.SearchAsync(String resourceType, IReadOnlyList`1 queryParameters, Boolean isHistory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Search/SearchService.cs:line 98\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.ExecuteSearchAndSaveToCache(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 331\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.GetSearchFromCacheOrCreate(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 320\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.ExecuteSearchAndSaveToCache(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 331\\r\\n   at Ihis.FhirEngine.Data.Core.Caching.ResourceRepositoryCacheService.GetSearchFromCacheOrCreate(IFhirContext fhirContext, String resourceType, IReadOnlyList`1 queryParameters, String cacheKey, String[] tags, Boolean isHistory, Func`2 searchResultFactory, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Data.Core/Caching/ResourceRepositoryCacheService.cs:line 320\\r\\n   at Synapxe.FhirWebApi.PostgresDoc.Handlers.AppointmentDataFhirHandler.ValidateNoAppointmentConflictAsync(IFhirContext context, Appointment appointment, CancellationToken cancellationToken) in C:\\\\workspace\\\\repo\\\\1.fhir\\\\FHIRNexus.Demo\\\\PostgreSQL\\\\Synapxe.FhirWebApi.PostgresDoc\\\\src\\\\Synapxe.FhirWebApi.PostgresDoc\\\\Handlers\\\\AppointmentDataFhirHandler.cs:line 64\\r\\n   at Ihis.FhirEngine.Core.Handlers.FhirHandlerExceptionWrapper.ProcessAsync(IFhirContext context, CancellationToken cancellationToken) in /agent/_work/1/s/src/Ihis.FhirEngine.Core/Handlers/FhirHandlerExceptionWrapper.cs:line 56\",\"location\":[\"ValidateNoAppointmentConflictOnCreate\"],\"expression\":[\"ValidateNoAppointmentConflictOnCreate\"]}]}","Action":"Create","ActionType":"C","StatusCode":500,"Duration":37.4509,"EventId":{"Id":9,"Name":"RequestResponseLog"},"SourceContext":"Microsoft.AspNetCore.HttpLogging.HttpLoggingMiddleware","RequestId":"0HND4MPOA7TJA:00000001","RequestPath":"/Appointment","ConnectionId":"0HND4MPOA7TJA","AppId":"Synapxe.FhirWebApi.PostgresDoc","AppVersion":"1.0.0+fcef90f242f3d21864a7ad36429586c1178cc125","MachineName":"\"WB-DESKTOP\""}
